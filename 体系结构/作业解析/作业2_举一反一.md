
## 题 1（反推参数）：四段地址序列 + 命中率 → 推断 cache 组织与替换策略
**来源**：UT Austin EE 460N Problem Set 4（题 8）:contentReference[oaicite:0]{index=0}  
（同一题也出现在 UCSD CSE 240A W12 Assignment 3 的题 5）:contentReference[oaicite:1]{index=1}  
（IIT Delhi COL216 练习题也有同款并给了解释/解答）:contentReference[oaicite:2]{index=2}  

**题目**  
某处理器有一个数据 cache。对每个“地址序列”执行完后，你只能观测到**该序列的 cache hit ratio**（命中率）。  
已知条件与取值范围（按题面给定）：
- 相联度：1 / 2 / 4 ways  
- 块大小：1 / 2 / 4 / 8 / 16 / 32 bytes  
- 总 cache 大小：256B 或 512B  
- 替换策略：LRU 或 FIFO  
- 假设：所有访问都是 **1 byte 访问**，地址是 **byte address**；**每个序列开始时 cache 都是空的**。

给定四条序列与命中率：

1. 序列 1：`[0, 2, 4, 8, 16, 32]`，Hit Ratio = `0.33`
2. 序列 2：`[0, 512, 1024, 1536, 2048, 1536, 1024, 512, 0]`，Hit Ratio = `0.33`
3. 序列 3：`[0, 64, 128, 256, 512, 256, 128, 64, 0]`，Hit Ratio = `0.33`
4. 序列 4：`[0, 512, 1024, 0, 1536, 0, 2048, 512]`，Hit Ratio = `0.25`

**要求**  
推断该 cache 的：
- 相联度  
- 块大小  
- 总大小  
- 替换策略（LRU / FIFO）  
并写出推断过程。


# 答案
第一题（四段地址序列 + 命中率）的**标准答案**在 UT Austin 的 Problem Set 4 官方解答里能直接查到：最终 cache 参数为

- **块大小（Block size）= 8 bytes** ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    
- **相联度（Associativity）= 4-way** ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    
- **总 cache 大小（Total cache size）= 256 B** ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    
- **替换策略（Replacement policy）= LRU** ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    

下面按四个序列把推断过程（你自己也能复现）简要写一遍：

---

## 1）用序列 1 锁定块大小 = 8B

序列 1：`0, 2, 4, 8, 16, 32`，命中率 0.33 = 2/6。  
解答中把不同 block size 的可达到命中数列成表：只有当 **block size=8B** 时，命中数刚好是 **2/6**（地址 2 和 4 与地址 0 落在同一个 8B 块里，所以能 hit，其余都 miss）。因此块大小确定为 8B。 ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))

---

## 2）用序列 2 锁定相联度 = 4-way

序列 2：`0, 512, 1024, 1536, 2048, 1536, 1024, 512, 0`，命中率 0.33 = 3/9。

关键观察：这些地址都是 **512 的倍数**。而 cache 总大小只可能是 256B 或 512B，所以这些地址会**映射到同一个 set**（解答里直接给出这一结论）。这样它就变成“同一 set 里竞争”的问题：

- 若 direct-mapped（1-way），第二次回访不可能出现 3 次 hit（解答算出最多 0/9）。
    
- 若 2-way，最多也只能 1/9。
    
- 若 4-way，可以达到 3/9，且与观测吻合，因此相联度 = 4-way。 ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    

---

## 3）用序列 3 锁定总容量 = 256B

序列 3：`0, 64, 128, 256, 512, 256, 128, 64, 0`，命中率 0.33 = 3/9。

在已经知道 **block=8B、4-way** 的前提下：

- 若总容量是 **256B**：set 数 = 256/(8*4)=8（也就是 3 个 index bit），解答指出这串地址会映射到同一个 set，并且 hit/miss 恰好给出 **3/9**。
    
- 若总容量是 **512B**：set 数=16（4 个 index bit），同样推一遍会得到更高的命中（解答展示会出现 4/9 的情况）。
    

因此总容量只能是 **256B**。 ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))

---

## 4）用序列 4 区分替换策略：LRU 而不是 FIFO

序列 4：`0, 512, 1024, 0, 1536, 0, 2048, 512`，命中率 0.25 = 2/8。

在 **block=8B、4-way、256B** 都已确定后，唯一剩下的是替换策略：

- 若是 **FIFO**，解答把该序列的 hit/miss 推出来是 `M M M H M H M H`，命中率 **3/8**，不符合观测 0.25。
    
- 若是 **LRU**，hit/miss 为 `M M M H M H M M`，命中率 **2/8 = 0.25**，与观测一致，因此替换策略是 **LRU**。 ([用户论坛](https://users.ece.utexas.edu/~patt/13s.460N/probs/ps4/ps4sol.html "EE 460N: Problem Set 4 Solution"))
    

---

如果你愿意，我可以再把这题“改成你截图那种：四段序列连续执行、不清空 cache”的版本，给出一组**新的命中率**，然后带你反推一次（会更像你作业题的思路训练）。